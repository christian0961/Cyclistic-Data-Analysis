---
title: 'Google Data Analytics Capstone Project : Cyclistic Data Analysis'
author: "Christian Soenggoro"
date: '2022-07-24'
output: html_document
---

# Load the necessary libraries

```{r message=FALSE, warning=FALSE}
library(readr)
library(tidyr)
library(tidyverse)
library(dplyr)
library(janitor)
library(ggplot2)
library(lubridate)
library(skimr)
library(forcats)
library(scales)
library(mapview)
library(here)
```


```{r}
here("202004-divvy-tripdata.csv")
```


## Load the data
```{r message=FALSE, warning=FALSE}
trips0 <- read_csv("Google Data Analytics/course 7 R code/202004-divvy-tripdata.csv")


```


## Check for NA values
```{r}
trips1 = trips0 %>% 
  is.na() %>% 
  colSums()
```





## Remove NA values and automatically clean column names

```{r}
trips2 = trips0 %>% 
  remove_empty(which = c("rows","cols")) %>% 
  clean_names()
```




## Change the latitude and longitude format from character to numeric type

```{r}
trips2 = trips2 %>% 
  mutate(start_lat = as.numeric(start_lat),
         start_lng = as.numeric(start_lng),
         end_lat = as.numeric(end_lat),
         end_lng = as.numeric(end_lng))
```




## Change format to date-time

```{r}
trips3 = trips2 %>% 
  mutate(started_at = as_datetime(started_at))
```



## Make new columns based on date-time information
```{r}
trips4 = trips3 %>% 
  mutate(hour_start = hour(started_at),
         week = week(started_at),
         weekday = wday(started_at, label =TRUE, abbr = FALSE),
         day = day(started_at),
         trip_time = difftime(ended_at, started_at,units = "min"))
```




## Change to factor data type and rename column for easier understanding

```{r}
trips5 = trips4 %>% 
  mutate(rideable_type = as_factor(rideable_type),
         member_casual = as_factor(member_casual)) %>% 
  rename(bikes = rideable_type,
         users = member_casual)
```


## Check for duplicate data

```{r}
trips5 %>% 
  duplicated() %>% 
  sum()
```



## Filter unlogical trip time

```{r}
trips6  = trips5 %>% 
  filter(between(trip_time,1,1440)) %>% 
  drop_na(end_lat, end_lng)
```



## Select columns that contains date-time information

```{r}
trips_time = trips6 %>% 
  select(ride_id,bikes,users,hour_start,week,weekday,day,trip_time)
```



## Select columns that contains location information
```{r}
trips_location =trips6 %>% 
  select(ride_id,bikes,users,start_station_name,start_lat,start_lng,end_station_name,start_station_id,
         end_lat,end_lng,end_station_id)
```

